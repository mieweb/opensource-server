<!-- Local rules -->

<!-- Modify it at your will. -->
<!-- Copyright (C) 2015, Wazuh Inc. -->

<!-- Example -->
<group name="local,syslog,sshd,">

  <!--
  Dec 10 01:02:02 host sshd[1234]: Failed none for root from 1.1.1.1 port 1066 ssh2
  -->
  <rule id="100001" level="5">
    <if_sid>5716</if_sid>
    <srcip>1.1.1.1</srcip>
    <description>sshd: authentication failed from IP 1.1.1.1.</description>
    <group>authentication_failed,pci_dss_10.2.4,pci_dss_10.2.5,</group>
  </rule>

</group>

<group name="local,iptables,sshd,bruteforce,">

  <!-- Base rule for SSH connection attempts detected by iptables -->
  <rule id="100002" level="5">
    <decoded_as>hypervisor-ssh-bruteforce</decoded_as>
    <location>intern-phxdc-pve1</location>
    <description>SSH connection attempt detected by iptables</description>
    <group>connection_attempt,</group>
  </rule>

  <!-- Frequency rule for SSH brute force detection -->
  <rule id="100003" level="10" frequency="5" timeframe="60">
    <if_matched_sid>100002</if_matched_sid>
    <location>intern-phxdc-pve1</location>
    <same_source_ip />
    <description>Possible SSH brute force detected - $(frequency) attempts in $(timeframe) seconds from $(srcip)</description>
    <mitre>
      <id>T1110</id> 
    </mitre>
  </rule>
</group>

